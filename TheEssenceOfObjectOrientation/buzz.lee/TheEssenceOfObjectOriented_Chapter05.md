"모듈이 어떻게 **커뮤니케이션**하는가"

"책임은 'How'가 아닌 '**What**' 을 결정해야한다."

"어떤 행위(**What**)가 필요한지를 결정한 후, 행위를 수행할 객체(**Who**)를 결정하라."

## 자율적인 책임

- 객체지향 공동체를 구성하는 기본 단위는 **자율적인 객체**
  - 자율적인 객체 : **스스로의 의지와 판단**에 따라 각자 맡은 **책임**을 수행하는 객체
  - 책임 : 요청을 처리하기 위해 객체가 수행하는 행동
- 적절한 책임의 선택이 전체 설계의 방향을 결정한다.
- 책임은 'How'가 아닌 '**What**' 을 결정해야한다.

### 자신의 의지에 따라 증언할 수 있는 자유

- 자율적인 객체가 되기 위해서는 할당되는 **책임이 자율적**이어야한다.
  - 과도하게 상세한 요청은 자율적인 책임을 제한한다.

```swift
protocol Justice {
  func judge(witness: Witness)
}

protocol Witness {
  func testify(scene: Scene)
}

struct King: Justice {
 
  ✅
  func judge(witness: Witness) {
    // '증언하라' 라는 요청(메시지)
    // Request에 대한 방식, 자료 등은 witness의 판단에 따라 선택
    // 자율적인 책임
    witness.testify(scene: crimeScene)
	}

  ❌
  func judgeDetaily(witness: Witness) {
		// 과도하게 상세한 요청
    // 요청에 'How'가 포함되어져 있다.
    // wintess의 자율적인 책임이 제한되어진다.
    // 타율적인 책임
    let memories = witness.recollect(scene: crimeScene)
    let reconstructedMemories = witness.reconstruct(memories, inOrder: chronological)
    witness.verbalize(reconstructedMemories)
  }
}
```

### 너무 추상적인 책임

- 협력의 의도를 명확하게 표현하지 못할 정도의 추상적인 책임은 좋지 않다.

```swift
struct King: Justice {
 
  ❌
  func judgeAbstractly(witness: Witness) {
    // 무엇을 설명해야하는가..?!
    witness.describe()
  }
}
```

## 메시지와 메서드

### 메시지

- 메시지는 'What'이 실행되기를 바라는지 명시한다.
- 객체는 메시지를 전송함으로써 다른 객체에 접근한다.
  - 다른 객체에 접근할 수 있는 유일한 방법이다.

```swift
func judge(witness: Witness) {
  // `testify` is Message Name
  // `scene` is Argument
  witness.testify(scene: crimeScene)
}
```

- Reciever(메시지를 수신받는 객체)는 해당 메시지를 처리할 수 있는 지 확인한다.
  - 이는 즉, 객체가 해당 메시지에 해당하는 **행동을 수행해야할 책임이 있다는 것**을 의미한다.
- Sender는 메시지 전송을 통하여 책임을 요청한다.
- Reciever는 메시지 수신을 통하여 책임을 수행한다.
  - 수신할 수 있는 메시지가 책임의 모양이다.

### 메서드

- 메시지를 처리하기 위하여 선택할 수 있는 **방법**
  - 처리 방법, 즉 메서드의 선택은 객체 내부의 결정에 따른다.

```swift
witness.testify(scene: crimeScene)

// `testify` is Message
// `someMethod()` is Method
func testify(scene: Scene) {
	someMethod()
}
```

### 다형성

- 서로 다른 유형의 객체가 동일한 메시지에 대하여 서로 다르게 반응하는 것
  - 메서드는 객체가 결정 내부적으로 결정한다.
- 동일한 역할을 수행할 수 잇는 객체들 사이의 **대체 가능성**을 의미한다.
- 객체 타입(Concrete)에 대한 결합도를 메시지에 대한 결합도로 낮춤으로써 다형성이 달성된다.
- 메시지에 대한 결합도
  - 협력의 유연성
  	- Concrete가 아닌 Abstract Reciever이기에 Reciever의 유연한 대체가 가능하다.
  - 협력이 수행되는 방식을 확장할 수 있다.
  - 협력이 수행되는 방식을 재활용할 수 있다.

## 메시지를 따라라

- 클래스는 추상화 도구의 일환일 뿐이다.
  - '속성과 행위를 담는 틀'에 불과하다.
- 클래스 중심의 설계는 유연성과 확장성이 떨어진다.
- 협력하는 객체들의 관점에서 시스템을 바라봐야 한다.
- 메시지를 주고 받는 **객체들** 사이의 **커뮤니케이션에 초점**을 맞춰라.
  - 메시지를 설계하고, 데이터를 설계하라.
- 독립적이 아닌, 객체를 **협력이라는 문맥** 안에서 생각하라.
  - 이를 통하여 행위를 고려할 수 있으며, 데이터에 대한 결정을 뒤로 미룰 수 있다.
- **메시지가 객체를 선택하게** 해야한다.

### 책임-주도 설계

- 책임을 완수하기 위하여 협력하는 객체들을 이용해 시스템을 설계하는 방법
- 어플리케이션
  1. 어플리케이션의 수행 기능은 시스템의 책임이다.
  2. 시스템의 책임을 객체의 책임으로 할당한다.
  3. 객체가 책임을 완수하기 위하여 다른 객체의 도움이 필요할 경우 **필요로하는 메시지를 결정**한다.
  4. 메시지 수진에 적합한 객체를 선택한다.
- 수신자는 송신자가 보낸 요청(메시지)를 처리할 책임이 있다.
  - 결과적으로, 메시지가 수신자의 책임을 결정한다.

### What/Who 사이클

- 어떤 행위(**What**)가 필요한지를 결정한 후, 행위를 수행할 객체(**Who**)를 결정하는 것
- 수신 가능한 메시지가 모여 객체의 **인터페이스**를 구성한다.

## 객체 인터페이스

### 인터페이스

- 두 대상이 마주치는 경계 지점에서 서로 상호작용할 수 있게 이어주는 방법 혹은 장치
- 특성
  - 내부 구조 혹은 방식을 몰라도 인터페이스만을 이용하여 의사를 전달할 수 있다.
  - 내부 구성이나 작동 방식만을 변경하는 것은 인터페이스를 사용하는 사용자에게는 영향을 미치지 않는다.
  - 동일한 인터페이스의 제공은 대상이 변경되더라도 문제가 발생하지 않는다.
- 인터페이스는 외부에서 접근 가능한 **Public Interface**와 내부만 가능한 Private Interface로 구분된다.
- 모든 인터페이스는 메시지 전송을 통해서만 접근할 수 있다.
  - 메시지 송신자가 자신일 경우 : Private Interface
  - 메시지 송신자가 자신이 아닐 경우 : Public Interface

## 인터페이스와 구현의 분리

### 객체 관점에서 생각하는 방법

- 원칙
  - 좀 더 추상적인 인터페이스
  - 최소 인터페이스
  	- 외부에서 사용할 필요가 없는 인터페이스는 최대한 노출하지 않는다.
  - 인터페이스와 구현 간에 차이가 있다는 점을 인식

### 구현

- 객체를 구성하지만 공용 인터페이스에 포함되지 않는 모든 것
  - e.g. 상태를 어떻게 표현할 것인가
- 객체의 외부와 내부를 분리하라
  - 이는 즉, 인터페이스와 구현을 분리하라

### 인터페이스와 구현의 분리 원칙

- 변경사항(수정)에 대한 유연한 수정이 가능하다.
  - 변경에 대응할때 외부에 대한 사이드 이펙트를 최소화하기 위하여 구현 부만을 수정한다.
- 송신자와 수신자가 인터페이스에 대해서만 결합되도록 만든다.
- 인터페이스를 제외한 구현은 내부에 숨겨 놓는다.
  - 이를, **캡슐화** 라고 한다.

### 캡슐화

- 구현을 외부로 부터 감추는 것
- 정보의 은닉

#### 상태와 행위의 캡슐화

- 객체는 상태와 행동을 하나의 단위로 묶는 자율적인 실체이다. (**데이터 캡슐화**)

#### 사적인 비밀의 캡슐화

- 외부의 객체는 인터페이스에만 의존해야 한다.

## 책임의 자율성이 협력의 품질을 결정한다

- **자율적인 책임은 협력을 단순하게 만든다.**
  - 세부적인 사항을 무시하고 의도를 드러낸다.
- 자율적인 책임은 외부와 내부를 명확하게 분리한다.
- 책임이 자율적일 경우 책임을 수행하는 내부적인 방법을 변경하더라도 외부에 영향을 미치지 않는다.
- 자율적인 책임은 협력의 대상을 다양하게 선택할 수 있는 유연성을 제공한다.
- 객체가 수행하는 책임들이 자율적일수록 객체의 역할을 이해하기 쉬워진다.
  - 객체의 존재 이유를 명확하게 표현할 수 있다.
